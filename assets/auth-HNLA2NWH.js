import{initializeApp as g}from"https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";import{getAuth as h,GithubAuthProvider as w,onAuthStateChanged as I,signInWithEmailAndPassword as E,createUserWithEmailAndPassword as P,sendEmailVerification as b,signOut as v,sendPasswordResetEmail as x}from"https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";import{getFirestore as B}from"https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}})();const A={apiKey:"AIzaSyCLFyJEgzqJw4sSxYoJfaiEklVJp3LTl2g",authDomain:"learn-better-together-21ddd.firebaseapp.com",projectId:"learn-better-together-21ddd",storageBucket:"learn-better-together-21ddd.firebasestorage.app",messagingSenderId:"836724963210",appId:"1:836724963210:web:e3cbec9877d3868534ba73",measurementId:"G-NGZS2PDF69"},y=g(A),o=h(y),S=B(y);new w;const m=new Map,C=6e4,L=5;function u(t){const e=Date.now(),s=(m.get(t)||[]).filter(r=>e-r<C);return s.length>=L?!1:(s.push(e),m.set(t,s),!0)}function c(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)&&t.length<=254}function T(t){return t&&t.length>=8}function l(t){return{"auth/email-already-in-use":"Email already in use. Try logging in instead.","auth/invalid-email":"Invalid email address.","auth/weak-password":"Password is too weak.","auth/user-not-found":"No account found with this email.","auth/wrong-password":"Incorrect password.","auth/too-many-requests":"Too many attempts. Please try again later.","auth/operation-not-allowed":"This operation is not allowed.","auth/invalid-credential":"Invalid email or password."}[t.code]||"An error occurred. Please try again."}function n(t,e=!1){const a=document.getElementById("message");a&&(a.textContent=t,a.style.display="block",a.style.backgroundColor=e?"#f8d7da":"#d4edda",a.style.color=e?"#721c24":"#155724",a.style.border=e?"1px solid #f5c6cb":"1px solid #c3e6cb",a.style.padding="10px",a.style.margin="10px 0",a.style.borderRadius="4px",setTimeout(()=>{a.style.display="none"},5e3))}I(o,t=>{if(t){const e=document.getElementById("auth-container"),a=document.getElementById("user-container");e&&(e.style.display="none"),a&&(a.style.display="block");const s=document.getElementById("user-email"),r=document.getElementById("display-email"),i=document.getElementById("email-verified");s&&(s.textContent=p(t.email)),r&&(r.textContent=p(t.email)),i&&(i.textContent=t.emailVerified?"Yes":"No")}else{const e=document.getElementById("auth-container"),a=document.getElementById("user-container");e&&(e.style.display="block"),a&&(a.style.display="none")}});function p(t){const[e,a]=t.split("@");return`${e.slice(0,2)+"*".repeat(Math.max(0,e.length-2))}@${a}`}async function $(){const t=document.getElementById("email"),e=document.getElementById("password");if(!t||!e)return;const a=t.value.trim(),s=e.value;if(!a||!s){n("Please enter both email and password",!0);return}if(!c(a)){n("Please enter a valid email address",!0);return}if(!T(s)){n("Password must be at least 8 characters",!0);return}if(!u(`signup_${a}`)){n("Too many signup attempts. Please try again later.",!0);return}try{const r=await P(o,a,s);await b(r.user),n("Account created! Please check your email for verification link."),t.value="",e.value=""}catch(r){n(l(r),!0)}}async function M(){const t=document.getElementById("email"),e=document.getElementById("password");if(!t||!e)return;const a=t.value.trim(),s=e.value;if(!a||!s){n("Please enter both email and password",!0);return}if(!c(a)){n("Please enter a valid email address",!0);return}if(!u(`signin_${a}`)){n("Too many login attempts. Please try again later.",!0);return}try{await E(o,a,s),n("Login successful!"),t.value="",e.value=""}catch(r){n(l(r),!0)}}async function R(){try{await v(o),n("Logged out successfully")}catch(t){n(l(t),!0)}}async function _(){const t=document.getElementById("email");let e=t?t.value.trim():"";if(!e&&(e=prompt("Enter your email address:"),!e)){n("Please enter your email address",!0);return}if(!c(e)){n("Please enter a valid email address",!0);return}if(!u(`reset_${e}`)){n("Too many password reset attempts. Please try again later.",!0);return}try{await x(o,e),n("Password reset email sent! Check your inbox.")}catch(a){n(l(a),!0)}}const f=document.getElementById("password");f&&f.addEventListener("keypress",t=>{t.key==="Enter"&&M()});export{M as a,R as b,o as c,S as d,_ as r,$ as s};
